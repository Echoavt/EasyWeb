<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>Plošinová hra</title>
<style>
body{margin:0;background:#add8e6;overflow:hidden;font-family:sans-serif;}
canvas{display:block;margin:0 auto;background:#add8e6;}
</style>
</head>
<body>
<canvas id="game" width="640" height="360"></canvas>
<script>
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');
const keys={};
let win=false;
const player={x:20,y:canvas.height-20,width:20,height:20,vx:0,vy:0};
const gravity=0.5,jump=-10,speed=3;
const platforms=[
    {x:80,y:280,width:140,height:20},
    {x:260,y:200,width:160,height:20},
    {x:460,y:120,width:120,height:20}
];
const goal={x:600,y:60,size:20};
function reset(){
    player.x=20;player.y=canvas.height-player.height;player.vx=0;player.vy=0;win=false;
}
window.addEventListener('keydown',e=>{keys[e.code]=true;if(e.code==='KeyR')reset();});
window.addEventListener('keyup',e=>{keys[e.code]=false;});
function update(){
    if(!win){
        if(keys['ArrowLeft'])player.vx=-speed;else if(keys['ArrowRight'])player.vx=speed;else player.vx=0;
        if(keys['ArrowUp']&&onGround())player.vy=jump;
    }else{player.vx=0;}
    player.vy+=gravity;
    player.x+=player.vx;
    player.y+=player.vy;
    let grounded=false;
    if(player.y+player.height>canvas.height){
        player.y=canvas.height-player.height;player.vy=0;grounded=true;
    }
    for(const p of platforms){
        if(player.x< p.x+p.width&&player.x+player.width>p.x&&player.y+player.height<=p.y&&player.y+player.height+player.vy>=p.y){
            player.y=p.y-player.height;player.vy=0;grounded=true;
        }
    }
    if(player.x<0)player.x=0;
    if(player.x+player.width>canvas.width)player.x=canvas.width-player.width;
    player._grounded=grounded;
    if(player.x+player.width>goal.x&&player.x<goal.x+goal.size&&player.y<goal.y+goal.size&&player.y+player.height>goal.y)win=true;
    draw();
    requestAnimationFrame(update);
}
function onGround(){return player._grounded;}
function draw(){
    ctx.fillStyle='#add8e6';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle='#555';
    for(const p of platforms)ctx.fillRect(p.x,p.y,p.width,p.height);
    ctx.fillStyle='yellow';
    ctx.beginPath();
    ctx.moveTo(goal.x,goal.y+goal.size);
    ctx.lineTo(goal.x+goal.size/2,goal.y);
    ctx.lineTo(goal.x+goal.size,goal.y+goal.size);
    ctx.closePath();
    ctx.fill();
    ctx.fillStyle='green';
    ctx.fillRect(player.x,player.y,player.width,player.height);
    if(win){
        ctx.fillStyle='black';
        ctx.font='24px sans-serif';
        ctx.fillText('Vyhráli jste!',canvas.width/2-70,canvas.height/2);
    }
}
reset();
update();
</script>
</body>
</html>
